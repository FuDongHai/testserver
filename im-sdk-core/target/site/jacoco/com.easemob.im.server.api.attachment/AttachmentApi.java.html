<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AttachmentApi.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">im-sdk-core</a> &gt; <a href="index.source.html" class="el_package">com.easemob.im.server.api.attachment</a> &gt; <span class="el_source">AttachmentApi.java</span></div><h1>AttachmentApi.java</h1><pre class="source lang-java linenums">package com.easemob.im.server.api.attachment;

import com.easemob.im.server.api.Context;
import com.easemob.im.server.api.attachment.download.Download;
import com.easemob.im.server.api.attachment.upload.Upload;
import com.easemob.im.server.model.EMAttachment;
import reactor.core.publisher.Mono;

import java.nio.file.Path;

/**
 * 附件API
 * TODO: 支持上传和下载带有密码的附件
 */
public class AttachmentApi {

    private Context context;
    
    private Upload upload;

    private Download download;

<span class="nc" id="L23">    public AttachmentApi(Context context) {</span>
<span class="nc" id="L24">        this.context = context;</span>
<span class="nc" id="L25">        this.upload = new Upload(context);</span>
<span class="nc" id="L26">        this.download =  new Download(context);</span>
<span class="nc" id="L27">    }</span>

    /**
     * 上传附件
     *
     * @param path 要上传的文件的路径
     * @return 上传完成后返回附件的id
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/basics/fileoperation#%E4%B8%8A%E4%BC%A0%E8%AF%AD%E9%9F%B3%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6&quot;&gt;上传附件&lt;/a&gt;
     */
    public Mono&lt;EMAttachment&gt; uploadFile(Path path) {
<span class="nc" id="L37">        return this.upload.fromLocalFile(path, false);</span>
    }

    /* TODO: 上传带有密码保护的附件 */

    /**
     * 下载附件
     * @param fileId 附件的id
     * @param dir 下载到哪个目录，如果不存在会自动创建
     * @param filename 下载到哪个文件
     * @return 下载完成后返回文件路径
     *
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/basics/fileoperation#%E4%B8%8B%E8%BD%BD%E8%AF%AD%E9%9F%B3%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6&quot;&gt;下载附件&lt;/a&gt;
     */
    public Mono&lt;Path&gt; downloadFile(String fileId, Path dir, String filename) {
<span class="nc" id="L52">        return this.download.toLocalFile(fileId, dir, filename);</span>
    }


}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>