<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BlockApi.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">im-sdk-core</a> &gt; <a href="index.source.html" class="el_package">com.easemob.im.server.api.block</a> &gt; <span class="el_source">BlockApi.java</span></div><h1>BlockApi.java</h1><pre class="source lang-java linenums">package com.easemob.im.server.api.block;

import com.easemob.im.server.api.Context;
import com.easemob.im.server.api.block.group.join.BlockUserJoinGroup;
import com.easemob.im.server.api.block.group.msg.BlockUserSendMsgToGroup;
import com.easemob.im.server.api.block.login.BlockUserLogin;
import com.easemob.im.server.api.block.room.join.BlockUserJoinRoom;
import com.easemob.im.server.api.block.room.msg.block.BlockUserSendMsgToRoom;
import com.easemob.im.server.api.block.room.msg.list.ListUsersBlockedSendMsgToRoom;
import com.easemob.im.server.api.block.room.msg.unblock.UnblockUserSendMsgToRoom;
import com.easemob.im.server.api.block.user.SendMsgToUser;
import com.easemob.im.server.model.EMBlock;
import reactor.core.publisher.Flux;
import reactor.core.publisher.Mono;

import java.time.Duration;

/**
 * 封禁API，提供封禁相关的功能。
 */
public class BlockApi {
    
    private SendMsgToUser sendMsgToUser;
    
    private BlockUserLogin blockUserLogin;
    
    private BlockUserJoinGroup blockUserJoinGroup;
    
    private BlockUserJoinRoom blockUserJoinRoom;
    
    private BlockUserSendMsgToGroup blockUserSendMsgToGroup;
    
    private UnblockUserSendMsgToRoom unblockUserSendMsgToRoom;

    private BlockUserSendMsgToRoom blockUserSendMsgToRoom;

    private ListUsersBlockedSendMsgToRoom listUsersBlockedSendMsgToRoom;

<span class="nc" id="L39">    public BlockApi(Context context) {</span>
<span class="nc" id="L40">        this.sendMsgToUser = new SendMsgToUser(context);</span>
<span class="nc" id="L41">        this.blockUserLogin = new BlockUserLogin(context);</span>
<span class="nc" id="L42">        this.blockUserJoinGroup = new BlockUserJoinGroup(context);</span>
<span class="nc" id="L43">        this.blockUserJoinRoom = new BlockUserJoinRoom(context);</span>
<span class="nc" id="L44">        this.blockUserSendMsgToGroup = new BlockUserSendMsgToGroup(context);</span>
<span class="nc" id="L45">        this.unblockUserSendMsgToRoom = new UnblockUserSendMsgToRoom(context);</span>
<span class="nc" id="L46">        this.blockUserSendMsgToRoom = new BlockUserSendMsgToRoom(context);</span>
<span class="nc" id="L47">        this.listUsersBlockedSendMsgToRoom = new ListUsersBlockedSendMsgToRoom(context);</span>
<span class="nc" id="L48">    }</span>

    /**
     * 获取禁言列表，即这个用户禁言的其他用户。
     *
     * @param username 发起禁言的用户名
     * @return 每个被禁言用户的用户的用户名或错误
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/ready/user#%E8%8E%B7%E5%8F%96%E9%BB%91%E5%90%8D%E5%8D%95&quot;&gt;获取用户禁言列表&lt;/a&gt;
     */
    public Flux&lt;EMBlock&gt; getUsersBlockedFromSendMsgToUser(String username) {
<span class="nc" id="L58">        return this.sendMsgToUser.getUsersBlocked(username);</span>
    }

    /**
     * 用户禁言，阻止向这个用户发消息。
     *
     * 要阻止 userA 给 userB发送消息:
     * &lt;code&gt;
     *      EMService service;
     *      service.block().blockUserFromSendingMessagesToUser(Flux.just(&quot;userA&quot;, &quot;userB&quot;), &quot;userC&quot;);
     * &lt;/code&gt;
     *
     * 注意，用户不能自己禁言自己。
     *
     * @param fromUser 被阻止的用户的用户名
     * @param toUser 接收消息的用户的用户名
     * @return 成功或错误
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/ready/user#%E6%B7%BB%E5%8A%A0%E9%BB%91%E5%90%8D%E5%8D%95&quot;&gt;添加用户禁言&lt;/a&gt;
     */
    public Mono&lt;Void&gt; blockUserSendMsgToUser(String fromUser, String toUser) {
<span class="nc" id="L78">        return this.sendMsgToUser.blockUser(fromUser, toUser);</span>
    }

    /**
     * 解除用户禁言，恢复向这个用户发消息。
     *
     * @param fromUser 被阻止的用户的用户名
     * @param toUser 接受消息的用户的用户名
     * @return 成功或错误
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/ready/user#%E7%A7%BB%E9%99%A4%E9%BB%91%E5%90%8D%E5%8D%95&quot;&gt;解除用户禁言&lt;/a&gt;
     */
    public Mono&lt;Void&gt; unblockUserSendMsgToUser(String fromUser, String toUser) {
<span class="nc" id="L90">        return this.sendMsgToUser.unblockUser(fromUser, toUser);</span>
    }

    /**
     * 用户账号禁用，阻止该用户登录。
     *
     * @param username 被阻止的用户的用户名
     * @return 成功或失败
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/ready/user#%E7%94%A8%E6%88%B7%E8%B4%A6%E5%8F%B7%E7%A6%81%E7%94%A8&quot;&gt;用户账号禁用&lt;/a&gt;
     */
    public Mono&lt;Void&gt; blockUserLogin(String username) {
<span class="nc" id="L101">        return this.blockUserLogin.blockUser(username);</span>
    }

    /**
     * 用户账号解禁，恢复该用户登录。
     *
     * @param username 被阻止的用户的用户名
     * @return 成功或失败
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/ready/user#&quot;&gt;用户账号解禁&lt;/a&gt;
     */
    public Mono&lt;Void&gt; unblockUserLogin(String username) {
<span class="nc" id="L112">        return this.blockUserLogin.unblockUser(username);</span>
    }

    /**
     * 获取阻止进群的用户列表。
     *
     * @param groupId 群id
     * @return 被阻止进入的用户名
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/basics/group#%E6%9F%A5%E8%AF%A2%E7%BE%A4%E7%BB%84%E9%BB%91%E5%90%8D%E5%8D%95&quot;&gt;获取阻止进群列表&lt;/a&gt;
     */
    public Flux&lt;EMBlock&gt; getUsersBlockedJoinGroup(String groupId) {
<span class="nc" id="L123">        return this.blockUserJoinGroup.getBlockedUsers(groupId);</span>
    }

    /**
     * 阻止进群。
     *
     * @param username 被阻止的用户的用户名
     * @param groupId 群id
     * @return 成功或错误
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/basics/group#%E6%B7%BB%E5%8A%A0%E5%8D%95%E4%B8%AA%E7%94%A8%E6%88%B7%E8%87%B3%E7%BE%A4%E7%BB%84%E9%BB%91%E5%90%8D%E5%8D%95&quot;&gt;阻止进群&lt;/a&gt;
     */
    public Mono&lt;Void&gt; blockUserJoinGroup(String username, String groupId) {
<span class="nc" id="L135">        return this.blockUserJoinGroup.blockUser(username, groupId);</span>
    }

    /**
     * 解除阻止进群。
     *
     * @param username 被阻止的用户的用户名
     * @param groupId 群id
     * @return 成功或错误
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/basics/group#%E4%BB%8E%E7%BE%A4%E7%BB%84%E9%BB%91%E5%90%8D%E5%8D%95%E7%A7%BB%E9%99%A4%E5%8D%95%E4%B8%AA%E7%94%A8%E6%88%B7&quot;&gt;&lt;/a&gt;
     */
    public Mono&lt;Void&gt; unblockUserJoinGroup(String username, String groupId) {
<span class="nc" id="L147">        return this.blockUserJoinGroup.unblockUser(username, groupId);</span>
    }

    /**
     * 获取阻止进聊天室的用户列表。
     *
     * @param roomId 聊天室id
     * @return 被阻止进入的用户名
     */
    public Flux&lt;EMBlock&gt; getUsersBlockedJoinRoom(String roomId) {
<span class="nc" id="L157">        return this.blockUserJoinRoom.getBlockedUsers(roomId);</span>
    }

    /**
     * 阻止进聊天室。
     *
     * @param username 被阻止的用户的用户名
     * @param roomId 聊天室id
     * @return 成功或错误
     */
    public Mono&lt;Void&gt; blockUserJoinRoom(String username, String roomId) {
<span class="nc" id="L168">        return this.blockUserJoinRoom.blockUser(username, roomId);</span>
    }

    /**
     * 解除阻止进聊天室。
     *
     * @param username 被阻止的用户的用户名
     * @param roomId 聊天室id
     * @return 成功或错误
     */
    public Mono&lt;Void&gt; unblockUserJoinRoom(String username, String roomId) {
<span class="nc" id="L179">        return this.blockUserJoinRoom.unblockUser(username, roomId);</span>
    }

    /**
     * 获取群禁言列表。
     *
     * @param groupId 群id
     * @return 每个禁言或错误.
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/basics/group#%E8%8E%B7%E5%8F%96%E7%A6%81%E8%A8%80%E5%88%97%E8%A1%A8&quot;&gt;获取禁言列表&lt;/a&gt;
     */
    public Flux&lt;EMBlock&gt; getUsersBlockedSendMsgToGroup(String groupId) {
<span class="nc" id="L190">        return this.blockUserSendMsgToGroup.getBlockedUsers(groupId);</span>
    }

    /**
     * 添加群禁言。
     *
     * @param username 被禁言的用户的用户名
     * @param groupId 群id
     * @param duration 禁言多长时间，为null则永久禁言
     * @return 成功或错误
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/basics/group#%E6%B7%BB%E5%8A%A0%E7%A6%81%E8%A8%80&quot;&gt;添加禁言&lt;/a&gt;
     */
    public Mono&lt;Void&gt; blockUserSendMsgToGroup(String username, String groupId, Duration duration) {
<span class="nc" id="L203">        return this.blockUserSendMsgToGroup.blockUser(username, groupId, duration);</span>
    }

    /**
     * 解除群禁言。
     *
     * @param username 被禁言的用户的用户名
     * @param groupId 群id
     * @return 成功或错误
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/basics/group#%E7%A7%BB%E9%99%A4%E7%A6%81%E8%A8%80&quot;&gt;移除禁言&lt;/a&gt;
     */
    public Mono&lt;Void&gt; unblockUserSendMsgToGroup(String username, String groupId) {
<span class="nc" id="L215">        return this.blockUserSendMsgToGroup.unblockUser(username, groupId);</span>
    }

    /**
     * 获取聊天室禁言列表。
     *
     * @param roomId 聊天室id
     * @return 每个禁言或错误
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/basics/chatroom#%E8%8E%B7%E5%8F%96%E7%A6%81%E8%A8%80%E5%88%97%E8%A1%A8&quot;&gt;获取禁言列表&lt;/a&gt;
     */
    public Flux&lt;EMBlock&gt; listUsersBlockedSendMsgToRoom(String roomId) {
<span class="nc" id="L226">        return this.listUsersBlockedSendMsgToRoom.all(roomId);</span>
    }

    /**
     * 添加聊天室禁言。
     *
     * @param username 被禁言的用户的用户名
     * @param roomId 聊天室id
     * @param duration 禁言时长，为null则永久禁言
     * @return 成功或错误
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/basics/chatroom#%E6%B7%BB%E5%8A%A0%E7%A6%81%E8%A8%80&quot;&gt;添加禁言&lt;/a&gt;
     */
    public Mono&lt;Void&gt; blockUserSendMsgToRoom(String username, String roomId, Duration duration) {
<span class="nc" id="L239">        return this.blockUserSendMsgToRoom.single(username, roomId, duration);</span>
    }

    /**
     * 解除聊天室禁言。
     *
     * @param username 被禁言的用户的用户名
     * @param roomId 聊天室id
     * @return 成功或错误
     * @see &lt;a href=&quot;http://docs-im.easemob.com/im/server/basics/chatroom#%E7%A7%BB%E9%99%A4%E7%A6%81%E8%A8%80&quot;&gt;移除禁言&lt;/a&gt;
     */
    public Mono&lt;Void&gt; unblockUserSendMsgToRoom(String username, String roomId) {
<span class="nc" id="L251">        return this.unblockUserSendMsgToRoom.single(username, roomId);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>